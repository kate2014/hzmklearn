!function(t){t._({"~name":"tpl.list","~superclass":t.base,ctor:function(){this.api="goods",this._super(),this.paginationCfg={pageSize:20},this.pageId=1},postCreate:function(){var t=this;this.$.loading.show(),this.$.create_time_start.cxCalendar(),this.$.create_time_end.cxCalendar(),this.$.searchBtn.keydown(function(i){var e=i.which;13==e&&t.$.searchBtn.click()}),$("body").keypress(function(i){13==i.keyCode&&t.searchResult()}),this.request("brand_list")},initLazyLoad:function(){new cobra.ImageLazyLoad({mode:"manual",scope:100})},tipInit:function(){$("[title]").poshytip({className:"tip-twitter",showTimeout:1,alignTo:"target",alignX:"center",offsetY:5,allowTipHover:!1,fade:!1,slide:!1})},getTplListArgs:function(){var t=(window.status||"",this.pageId?this.pageId:1);return{type:"get",data:{key:this.$.good_key.val(),brand_key:this.$.brand_key?this.$.brand_key.val():"",start_time:this.$.create_time_start.val(),end_time:this.$.create_time_end.val(),current_page:t,page_size:this.paginationCfg.pageSize},done:cobra.ride(this,function(t){this.$.loading.hide();var i="template>tpl_list_item";return $.when(this.compile(this.$.tpl_list_box,i,t)).done(cobra.ride(this,function(){})).fail(function(){}),$.when(this.compile(this.$.pageination,"goods>goods_list_pageination",this.initPaginationData(t))).done(cobra.ride(this,function(){})).fail(function(){}),t}),fail:function(){}}},brand_listArgs:function(){var t=this;return{type:"post",data:{},done:cobra.ride(t,function(i){$.when(this.compile(this.$.brand_key,"goods>brand_key",i)).done(cobra.ride(this,function(){this.request("getTplList")})).fail(function(i){arguments.length>1&&t._msgBox.warn(i.responseInfo.reasons.msg)})}),fail:function(t){arguments.length>1&&this._msgBox.warn(t.responseInfo.reasons.msg)}}},modifyTpl:function(t){window.location.href="../seller_goods_management/tpl_modify.html?template_id="+t},deleteTpl:function(t){var i=this;miniDialog.confirm('<span style="color:red;font-weight:700;">确认要删除该模板?</span>',function(){i.delTplArgs=null,i.delTplArgs=function(){return{type:"get",data:{template_id:t},done:cobra.ride(i,function(t){console.log(t),this._msgBox.done("删除模板成功"),setTimeout(function(){window.location.reload()},800)}),fail:function(t){arguments.length>1&&this._msgBox.info(t.msg||"网络异常，请稍候再试")}}},i.request("delTpl")},function(){},{title:"温馨提示",width:300})},search_box_change:function(){var t=this,i=t.$.goods_search_input.val();""!=$.trim(i)&&this.request("goods_name_search")},goods_name_searchArgs:function(){var t=this;return{type:"post",data:{search_name:t.$.goods_search_input.val()},done:cobra.ride(t,function(i){$.when(this.compile(this.$.goods_search_result,"goods>goods_search_result_item",i)).done(cobra.ride(this,function(){this.$.goods_search_result.show()})).fail(function(i){arguments.length>1&&t._msgBox.warn(i.responseInfo.reasons.msg)})}),fail:function(t){arguments.length>1&&this._msgBox.warn(t.responseInfo.reasons.msg)}}},select_search_result:function(t){this.$.goods_search_result.hide(),this.$.goods_search_input.val(t)},goods_searchArgs:function(){var t=this;return{type:"get",data:{search_name:t.$.goods_search_input.val()},done:cobra.ride(t,function(t){return $.when(this.compile(this.$.tpl_list_box,"goods>goods_list_item",t)).done(cobra.ride(this,function(){this.initLazyLoad()})).fail(function(){}),$.when(this.compile(this.$.pageination,"goods>goods_list_pageination",this.initPaginationData(t))).done(cobra.ride(this,function(){})).fail(function(){}),t}),fail:function(t){arguments.length>1&&this._msgBox.warn(t.responseInfo.reasons.msg)}}},search_submit:function(){this.$.goods_search_result.hide(),this.request("goods_search")},goPage:function(t){this.pageId=t,this.$.loading.show(),this.request("getTplList")},searchResult:function(){this.pageId=1,this.$.loading.show(),this.request("getTplList")},initPaginationData:function(t){return{page:Number(this.pageId),pagesize:this.paginationCfg.pageSize,total:Number(t.data.total_count),total_pages:Math.ceil(t.data.total_count/this.paginationCfg.pageSize)}}}),$(function(){new tpl.list})}(cobra);